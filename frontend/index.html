<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/verisafe-logo.svg" />
    <link rel="apple-touch-icon" href="/verisafe-logo.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VeriSafe - Privacy-Preserving Age Verification</title>
  </head>
  <body>
    <div id="root"></div>
    <!-- Polyfill for CommonJS globals (module, exports, require) - must be before any other scripts -->
    <script>
      // Define module polyfill for CommonJS compatibility (needed by relayer-sdk)
      var moduleObj = { exports: {} };
      if (typeof module === 'undefined') {
        window.module = moduleObj;
      }
      if (typeof globalThis !== 'undefined' && typeof globalThis.module === 'undefined') {
        globalThis.module = moduleObj;
      }
      
      // Define exports - in CommonJS, exports is a reference to module.exports
      if (typeof exports === 'undefined') {
        // exports should point to module.exports
        try {
          window.exports = moduleObj.exports;
        } catch (e) {
          window.exports = {};
        }
      }
      if (typeof globalThis !== 'undefined' && typeof globalThis.exports === 'undefined') {
        try {
          globalThis.exports = moduleObj.exports;
        } catch (e) {
          globalThis.exports = {};
        }
      }
      
      // Define require polyfill for CommonJS compatibility (needed by relayer-sdk)
      // Create stub objects for common Node.js modules that might be required at runtime
      var stubModules = {
        'stream': function() { return {}; },
        './lib/_stream_readable': function() { return {}; },
        './lib/_stream_writable': function() { return {}; },
        './lib/_stream_duplex': function() { return {}; },
        './lib/_stream_transform': function() { return {}; },
        './lib/_stream_passthrough': function() { return {}; },
        './lib/internal/streams/end-of-stream': function() { return {}; },
        './lib/internal/streams/pipeline': function() { return {}; }
      };
      
      if (typeof require === 'undefined') {
        // Improved require implementation - returns stubs for known modules
        window.require = function(id) {
          // Check if we have a stub for this module
          if (stubModules[id]) {
            console.warn('require() called for:', id, '- Using stub module');
            return stubModules[id]();
          }
          // For unknown modules, return a minimal object to prevent "undefined" errors
          console.warn('require() called for:', id, '- This should be handled by Vite\'s module system');
          // Return a minimal object that can be extended/inherited
          return { default: {}, __esModule: true };
        };
      }
      if (typeof globalThis !== 'undefined' && typeof globalThis.require === 'undefined') {
        globalThis.require = function(id) {
          if (stubModules[id]) {
            console.warn('require() called for:', id, '- Using stub module');
            return stubModules[id]();
          }
          console.warn('require() called for:', id, '- This should be handled by Vite\'s module system');
          return { default: {}, __esModule: true };
        };
      }
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
