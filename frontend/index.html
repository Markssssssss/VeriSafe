<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/verisafe-logo.svg" />
    <link rel="apple-touch-icon" href="/verisafe-logo.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VeriSafe - Privacy-Preserving Age Verification</title>
  </head>
  <body>
    <div id="root"></div>
    <!-- Polyfill for CommonJS globals (module, exports, require) - must be before any other scripts -->
    <script>
      // Define module polyfill for CommonJS compatibility (needed by relayer-sdk)
      var moduleObj = { exports: {} };
      if (typeof module === 'undefined') {
        window.module = moduleObj;
      }
      if (typeof globalThis !== 'undefined' && typeof globalThis.module === 'undefined') {
        globalThis.module = moduleObj;
      }
      
      // Define exports - in CommonJS, exports is a reference to module.exports
      if (typeof exports === 'undefined') {
        // exports should point to module.exports
        try {
          window.exports = moduleObj.exports;
        } catch (e) {
          window.exports = {};
        }
      }
      if (typeof globalThis !== 'undefined' && typeof globalThis.exports === 'undefined') {
        try {
          globalThis.exports = moduleObj.exports;
        } catch (e) {
          globalThis.exports = {};
        }
      }
      
      // Define require polyfill for CommonJS compatibility (needed by relayer-sdk)
      // Create a base class that can be extended (for stream modules)
      function BaseStreamClass() {}
      BaseStreamClass.prototype = {};
      
      // Create stub constructors for common Node.js modules that might be required at runtime
      var stubModules = {
        'stream': BaseStreamClass,
        './lib/_stream_readable': BaseStreamClass,
        './lib/_stream_readable.js': BaseStreamClass,
        './lib/_stream_writable': BaseStreamClass,
        './lib/_stream_writable.js': BaseStreamClass,
        './lib/_stream_duplex': BaseStreamClass,
        './lib/_stream_duplex.js': BaseStreamClass,
        './lib/_stream_transform': BaseStreamClass,
        './lib/_stream_transform.js': BaseStreamClass,
        './lib/_stream_passthrough': BaseStreamClass,
        './lib/_stream_passthrough.js': BaseStreamClass,
        './lib/internal/streams/end-of-stream': BaseStreamClass,
        './lib/internal/streams/end-of-stream.js': BaseStreamClass,
        './lib/internal/streams/pipeline': BaseStreamClass,
        './lib/internal/streams/pipeline.js': BaseStreamClass
      };
      
      if (typeof require === 'undefined') {
        // Improved require implementation - returns constructors for known modules
        window.require = function(id) {
          // Remove .js extension for matching
          var idWithoutExt = id.replace(/\.js$/, '');
          
          // Check if we have a stub for this module (with or without .js)
          if (stubModules[id] || stubModules[idWithoutExt]) {
            var stub = stubModules[id] || stubModules[idWithoutExt];
            console.warn('require() called for:', id, '- Using stub constructor');
            // Return the constructor itself (not call it)
            return stub;
          }
          // For unknown modules, return a constructor class that can be extended
          console.warn('require() called for:', id, '- This should be handled by Vite\'s module system');
          // Return a constructor that can be extended
          return BaseStreamClass;
        };
      }
      if (typeof globalThis !== 'undefined' && typeof globalThis.require === 'undefined') {
        globalThis.require = function(id) {
          var idWithoutExt = id.replace(/\.js$/, '');
          if (stubModules[id] || stubModules[idWithoutExt]) {
            var stub = stubModules[id] || stubModules[idWithoutExt];
            console.warn('require() called for:', id, '- Using stub constructor');
            return stub;
          }
          console.warn('require() called for:', id, '- This should be handled by Vite\'s module system');
          return BaseStreamClass;
        };
      }
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
